{
  "$id": "https://github.com/projectronin/contract-event-model-derivation-results/blob/main/v1/model-derivation-results-v1.schema.json",
  "title": "Model Derivation Results V1",
  "description": "Model derived resources",
  "type": "object",
  "additionalProperties":false,
  "properties": {
    "indexedOn": {
      "type": "object",
      "description": "This represents a resource that the derived resources index on",
      "additionalProperties":false,
      "properties": {
        "dataAuthority": {
          "description": "Codeable concept to represent the authority of the resource",
          "$ref": "#/$defs/codeableConcept"
        },
        "resource": {
          "type": "object",
          "description": "The FHIR type and ID associated to this resource",
          "additionalProperties":false,
          "properties": {
            "type": {
              "type": "string"
            },
            "id": {
              "type": "string"
            }
          },
          "required":["type", "id"]
        },
        "tenantId": {
          "description": "The ID of the tenant to retrieve the resource",
          "type": "string"
        }
      },
      "required":["dataAuthority", "resource", "tenantId"]
    },
    "artifact": {
      "type": "object",
      "description": "The name and the version of the artifact (e.g. machine learning model, clinical logic) used to generate resources",
      "additionalProperties":false,
      "properties": {
        "name": {
          "type": "string"
        },
        "version": {
          "type": "string"
        }
      },
      "required":["name", "version"]
    },
    "resources": {
      "type": "array",
      "description": "The list of FHIR resources generated by the artifact",
      "items": {
        "type": "object"
      }
    }
  },
  "required":["indexedOn", "artifact", "resources"],
  "$defs":  {
    "coding": {
      "type": "object",
      "description": "This defines the required attributed for a FHIR code",
      "properties": {
        "system": {
          "description": "The coding system that defines what the code represents",
          "type": "string"
        },
        "code": {
          "description": "The specific code determined by the system that specifies the value.",
          "type": "string"
        },
        "display": {
          "description": "The human readable value for the code",
          "type": "string"
        },
        "version": {
          "description": "The specific version of the system where the code is defined",
          "type": "string"
        }
      },
      "required": ["system", "code", "display"]
    },
    "codeableConcept": {
      "type":"object",
      "description": "This is a CodeableConcept with an extracted emrText attribute that dictates the correct value to represent in an EMR context.",
      "properties": {
        "coding": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/coding"
          },
          "minItems": 1
        }
      }
    }
  }
}
